<h1 class="mb-4">My dreams</h1>

<% @dreams.each do |dream| %>
  <div class="mb-4 p-4 rounded-4 shadow" style="background-color: #1f1033; border: 1px solid rgba(255, 255, 255, 0.05);">
    <h5 class="mb-2"><%= dream.title %></h5>
    <p class="text-muted mb-3"><strong>Visibility:</strong> <%= dream.private ? "Private" : "Public" %></p>

    <% if dream.audio.attached? %>
      <audio controls class="w-100 mb-3">
        <source src="<%= url_for(dream.audio) %>" type="<%= dream.audio.content_type %>">
        Your browser does not support the audio element.
      </audio>
    <% else %>
      <p><em>No recording available.</em></p>
    <% end %>

    <div class="d-flex flex-wrap gap-2 justify-content-start">
      <%= link_to "Modify", edit_dream_path(dream), class: "gradient-button" %>

      <% if dream.audio.attached? %>
        <% if dream.transcription.present? %>
          <%= link_to "View Transcription", dream_transcription_path(dream), class: "gradient-button" %>
        <% else %>
          <%= link_to "Transcribe", transcribe_dream_path(dream), method: :post, class: "gradient-button" %>
        <% end %>
      <% end %>

      <%= link_to "Delete", dream_path(dream), method: :delete, data: { confirm: "Are you sure you want to delete this dream?" }, class: "gradient-button" %>
    </div>
  </div>

  <!-- Navbar -->
  <%= render "shared/bottom_nav" %>

<% end %>
